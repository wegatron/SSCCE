code from : http://www.gii.upv.es/tlsf/main/repo.html